{% load static i18n %}

<table id="log-entries-table"
       class="mt-6 w-full border-collapse dark:bg-slate-800">
    <thead>
    <tr>
        <th scope="col"
            class="border p-2 dark:border-gray-700 dark:bg-slate-700 dark:text-white">
            {% trans 'No.' %}
        </th>
        <th scope="col"
            class="border p-2 dark:border-gray-700 dark:bg-slate-700 dark:text-white">
            {% trans 'Log entries' %}
        </th>
    </tr>
    </thead>
    <tbody id="log-entries-data" x-data="{ copiedValue: '' }">
    {% if log_entries %}
        {% for log_entry in log_entries %}
            <tr class="hover:bg-gray-100 dark:hover:bg-gray-500 dark:bg-slate-700 dark:text-white dark:border-gray-700">
                <td class="border p-2 dark:border-gray-700">{{ forloop.counter }}</td>
                <td class="border p-2 relative break-words dark:border-gray-700 dark:text-white">
                    <div class="flex items-center">
                        <div class="flex-grow min-w-0">
                            {{ log_entry }}
                        </div>
                        <div x-data="{ showMsg: false }">
                            <i @click="copyText($event); showMsg = true; setTimeout(() => showMsg = false, 2000)"
                               class="fa-solid fa-copy copy-icon p-2 focus:outline-none cursor-pointer">
                            </i>
                            <div x-show="showMsg" @click.away="showMsg = false"
                                 class="message fixed bottom-3 right-3 z-20 max-w-sm overflow-hidden bg-green-100 border
                                        border-green-300 rounded p-3 flex items-center justify-center text-green-600
                                        dark:bg-gray-700 dark:border-gray-600 dark:text-white"
                                 style="position: fixed; bottom: 20px; right: 20px; display: none;">
                                {% trans 'Copied to Clipboard' %}
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        {% endfor %}
    {% else %}
        <tr class="hover:bg-gray-100 dark:hover:bg-gray-700">
            <td class="border p-2 dark:border-gray-700 dark:bg-slate-700 dark:text-white dark:border-gray-700"
                colspan="2">{% trans 'No entries!' %}
            </td>
        </tr>
    {% endif %}

    </tbody>

    <tfoot id="log-entries-footer" class="dark:bg-slate-800">
    <tr>
        <td colspan="2" class="dark:bg-slate-800 dark:border-gray-700 dark:text-white">
            <div class="flex items-center justify-center mt-4 dark:bg-slate-800">
                {% if log_entries.has_previous %}
                    <span class="px-4 py-2 border border-gray-300 rounded-l cursor-pointer dark:border-gray-700"
                          hx-get="{% url 'log_inspector:log_entries' filename=filename %}?page={{ log_entries.previous_page_number }}"
                          hx-target="#log-entries-table"
                          hx-swap="outerHTML">
                {% trans 'Previous' %}
            </span>
                {% endif %}
                {% for page_num in log_entries.paginator.page_range %}
                    {% if page_num == log_entries.number %}
                        <span class="px-4 py-2 bg-blue-500 text-white rounded-md dark:bg-slate-600 dark:text-white">
                    {{ page_num }}
                </span>
                    {% elif page_num == 1 or page_num == log_entries.paginator.num_pages %}
                        <span class="px-4 py-2 border border-gray-300 rounded-md cursor-pointer dark:border-gray-700"
                              hx-get="{% url 'log_inspector:log_entries' filename=filename %}?page={{ page_num }}"
                              hx-target="#log-entries-table"
                              hx-swap="outerHTML">
                    {{ page_num }}
                </span>
                    {% elif page_num > log_entries.number|add:'-3' and page_num < log_entries.number|add:'3' %}
                        <span class="px-4 py-2 border border-gray-300 rounded-md cursor-pointer dark:border-gray-700"
                              hx-get="{% url 'log_inspector:log_entries' filename=filename %}?page={{ page_num }}"
                              hx-target="#log-entries-table"
                              hx-swap="outerHTML">
                    {{ page_num }}
                </span>
                    {% elif page_num == log_entries.number|add:'-3' or page_num == log_entries.number|add:'3' %}
                        <span class="px-4 py-2 dark:border-gray-700">...</span>
                    {% endif %}
                {% endfor %}

                {% if log_entries.has_next %}
                    <span class="px-4 py-2 border border-gray-300 rounded-r cursor-pointer dark:border-gray-700"
                          hx-get="{% url 'log_inspector:log_entries' filename=filename %}?page={{ log_entries.next_page_number }}"
                          hx-target="#log-entries-table"
                          hx-swap="outerHTML">
                {% trans 'Next' %}
            </span>
                {% endif %}
            </div>
        </td>
    </tr>
    </tfoot>
</table>